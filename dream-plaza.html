<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>梦境详情 - DreamWhisper</title>
    <link rel="canonical" href="https://dreamwhisperai.com/dream-plaza.html">
    <meta property="og:url" content="https://dreamwhisperai.com/index.html">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Nunito:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { background: linear-gradient(135deg, #1e1b4b 0%, #4c1d95 50%, #831843 100%); color: white; font-family: 'Nunito', sans-serif; min-height: 100vh; }
        .glass-panel { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(16px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .glass-tag { background: rgba(255, 255, 255, 0.1); padding: 4px 12px; border-radius: 99px; font-size: 0.8rem; }
        
        /* 简单的 Toast 动画 */
        .toast-enter { transform: translate(-50%, 0) !important; opacity: 1 !important; }
    </style>
</head>
<body class="pb-20 flex flex-col min-h-screen">

    <!-- Navigation -->
    <nav class="w-full p-6 flex justify-between items-center bg-black/20 backdrop-blur-md sticky top-0 z-50 border-b border-white/5">
        <a href="index.html" class="flex items-center gap-2 hover:text-pink-300 transition group">
            <i class="fa-solid fa-moon text-pink-400 group-hover:animate-pulse"></i>
            <span class="font-serif font-bold text-xl tracking-wide">DreamWhisper</span>
        </a>
        
        <!-- Language Selector -->
        <div class="relative group cursor-pointer z-50">
            <button class="flex items-center gap-2 px-3 py-1 rounded-full border border-white/10 hover:bg-white/5 transition-all text-sm">
                <i class="fa-solid fa-globe text-pink-300"></i>
                <span id="currentLangLabel">中文</span>
                <i class="fa-solid fa-chevron-down text-xs opacity-70"></i>
            </button>
            <div class="absolute right-0 pt-2 hidden group-hover:block w-32">
                <div class="glass-panel rounded-xl overflow-hidden shadow-xl border-pink-300/20 bg-[#1A1625]">
                    <button onclick="changeLanguage('zh')" class="block w-full text-left px-4 py-2 hover:bg-pink-500/20 text-white transition-colors text-sm">中文</button>
                    <button onclick="changeLanguage('en')" class="block w-full text-left px-4 py-2 hover:bg-pink-500/20 text-white transition-colors text-sm">English</button>
                </div>
            </div>
        </div>
    </nav>

    <main class="container mx-auto px-4 mt-8 max-w-4xl flex-grow">
        
        <!-- Back Link -->
        <div class="mb-6">
            <a href="index.html" class="text-pink-300/70 hover:text-pink-300 text-sm flex items-center gap-1 transition-colors w-fit">
                <i class="fa-solid fa-arrow-left"></i> <span data-i18n="back_home">返回首页</span>
            </a>
        </div>

        <!-- Dream Header -->
        <div class="glass-panel rounded-3xl p-8 md:p-12 mb-8 relative overflow-hidden">
            <!-- 装饰背景光 -->
            <div class="absolute top-0 right-0 w-64 h-64 bg-pink-500/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 pointer-events-none"></div>

            <div class="flex gap-3 mb-6 relative z-10">
                <span class="glass-tag text-purple-200" data-i18n="tag_chase">#追逐</span>
                <span class="glass-tag text-blue-200" data-i18n="tag_lost">#迷路</span>
                <span class="glass-tag text-gray-300" data-i18n="time_ago">2小时前</span>
            </div>
            
            <h1 class="text-3xl md:text-5xl font-serif font-bold mb-8 leading-tight relative z-10" data-i18n="dream_title">总是梦见在旧学校里找不到教室</h1>
            
            <div class="text-lg leading-relaxed text-gray-200 space-y-4 font-light relative z-10">
                <p data-i18n="dream_p1">梦里我很着急，上课铃已经响了很久，声音尖锐得刺耳。我知道我必须去高三（2）班上数学课，但我怎么也找不到那栋教学楼。</p>
                <p data-i18n="dream_p2">走廊变得无限长，所有的门都关着，颜色是那种斑驳的深绿色。我推开一扇门，里面却是完全陌生的仓库，堆满了旧课桌。我开始奔跑，但双腿像灌了铅一样沉重。</p>
                <p data-i18n="dream_p3">最可怕的是，我手里紧紧攥着一张试卷，但我看不清上面的分数...</p>
            </div>

            <!-- Interaction Bar -->
            <div class="mt-8 pt-8 border-t border-white/10 flex justify-between items-center relative z-10">
                <div class="flex gap-6 text-gray-400">
                    <button class="hover:text-pink-400 transition flex items-center gap-2 group">
                        <i class="fa-regular fa-heart group-hover:scale-110 transition-transform"></i> 124
                    </button>
                    <button class="hover:text-purple-400 transition flex items-center gap-2 group">
                        <i class="fa-regular fa-comment group-hover:scale-110 transition-transform"></i> 18
                    </button>
                </div>
                <!-- 修复后的分享按钮 -->
                <button onclick="handleShare()" class="text-gray-400 hover:text-pink-300 transition flex items-center gap-2 px-3 py-1 rounded-full hover:bg-white/5 active:scale-95">
                    <i class="fa-solid fa-share-nodes"></i> 
                    <span data-i18n="btn_share">分享</span>
                </button>
            </div>
        </div>

        <!-- AI Analysis Section -->
        <div class="glass-panel rounded-3xl p-8 border-l-4 border-pink-500 bg-gradient-to-r from-pink-900/20 to-transparent mb-8">
            <div class="flex items-center gap-3 mb-6">
                <div class="w-8 h-8 rounded-full bg-pink-500 flex items-center justify-center"><i class="fa-solid fa-robot text-white text-xs"></i></div>
                <h3 class="text-xl font-bold text-pink-200" data-i18n="ai_title">AI 深度解析</h3>
            </div>
            
            <div class="space-y-6">
                <div>
                    <h4 class="text-sm font-bold text-gray-400 uppercase tracking-wider mb-2" data-i18n="label_metaphor">心理隐喻</h4>
                    <p class="text-gray-200" data-i18n="analysis_metaphor">“找不到教室”是典型的焦虑梦。学校通常象征着社会评价体系或工作环境。你可能正在面对某个“考试”（项目、评估或抉择），并感到自己准备不足。</p>
                </div>
                <div>
                    <h4 class="text-sm font-bold text-gray-400 uppercase tracking-wider mb-2" data-i18n="label_advice">潜意识建议</h4>
                    <p class="text-gray-200" data-i18n="analysis_advice">你看不清试卷的分数，说明结果其实还没确定，恐惧源于未知的想象。建议本周尝试将大任务拆解，找回具体的掌控感。</p>
                </div>
            </div>
        </div>

        <!-- Related Dreams -->
        <div class="mt-12 mb-20">
            <h3 class="text-2xl font-serif font-bold mb-6" data-i18n="related_title">相似的梦境</h3>
            <div class="grid md:grid-cols-2 gap-4">
                <a href="#" class="glass-panel p-4 rounded-xl hover:bg-white/5 transition block group">
                    <div class="text-sm font-bold text-pink-200 mb-1 group-hover:text-pink-300 transition-colors" data-i18n="rel_1_title">错过高考</div>
                    <div class="text-xs text-gray-400" data-i18n="rel_1_desc">总是梦见准考证丢了...</div>
                </a>
                <a href="#" class="glass-panel p-4 rounded-xl hover:bg-white/5 transition block group">
                    <div class="text-sm font-bold text-pink-200 mb-1 group-hover:text-pink-300 transition-colors" data-i18n="rel_2_title">迷宫电梯</div>
                    <div class="text-xs text-gray-400" data-i18n="rel_2_desc">电梯永远不到我要去的楼层...</div>
                </a>
            </div>
        </div>
    </main>

    <!-- Toast Notification (Hidden by default) -->
    <div id="toast" class="fixed bottom-10 left-1/2 transform -translate-x-1/2 translate-y-20 opacity-0 bg-white text-purple-900 px-6 py-3 rounded-full shadow-2xl font-bold transition-all duration-300 z-50 pointer-events-none flex items-center gap-2">
        <i class="fa-solid fa-check-circle text-green-500"></i>
        <span id="toastMsg">链接已复制</span>
    </div>

    <script>
        // Store current language globally
        let currentLang = 'zh';

        const translations = {
            zh: {
                back_home: "返回首页",
                tag_chase: "#追逐", tag_lost: "#迷路", time_ago: "2小时前",
                dream_title: "总是梦见在旧学校里找不到教室",
                dream_p1: "梦里我很着急，上课铃已经响了很久，声音尖锐得刺耳。我知道我必须去高三（2）班上数学课，但我怎么也找不到那栋教学楼。",
                dream_p2: "走廊变得无限长，所有的门都关着，颜色是那种斑驳的深绿色。我推开一扇门，里面却是完全陌生的仓库，堆满了旧课桌。我开始奔跑，但双腿像灌了铅一样沉重。",
                dream_p3: "最可怕的是，我手里紧紧攥着一张试卷，但我看不清上面的分数...",
                btn_share: "分享",
                ai_title: "AI 深度解析",
                label_metaphor: "心理隐喻",
                analysis_metaphor: "“找不到教室”是典型的焦虑梦。学校通常象征着社会评价体系或工作环境。你可能正在面对某个“考试”（项目、评估或抉择），并感到自己准备不足。",
                label_advice: "潜意识建议",
                analysis_advice: "你看不清试卷的分数，说明结果其实还没确定，恐惧源于未知的想象。建议本周尝试将大任务拆解，找回具体的掌控感。",
                related_title: "相似的梦境",
                rel_1_title: "错过高考", rel_1_desc: "总是梦见准考证丢了...",
                rel_2_title: "迷宫电梯", rel_2_desc: "电梯永远不到我要去的楼层...",
                // New translations for share function
                msg_copied: "链接已复制到剪贴板",
                msg_share_fail: "无法分享"
            },
            en: {
                back_home: "Back Home",
                tag_chase: "#Chase", tag_lost: "#Lost", time_ago: "2h ago",
                dream_title: "Can't find the classroom in old school",
                dream_p1: "I was anxious in my dream. The bell had been ringing for a long time, piercingly loud. I knew I had to go to Class 2, Grade 12 for math, but I couldn't find the building.",
                dream_p2: "The corridor became infinitely long, all doors closed, painted a mottled dark green. I pushed one open, but it was a strange warehouse piled with old desks. I tried to run, but my legs felt like lead.",
                dream_p3: "The scariest part was that I was clutching a test paper, but I couldn't see the score...",
                btn_share: "Share",
                ai_title: "AI Deep Analysis",
                label_metaphor: "Psychological Metaphor",
                analysis_metaphor: "'Can't find the classroom' is a typical anxiety dream. Schools often symbolize social evaluation systems or work environments. You may be facing a 'test' (project, assessment, or choice) and feel unprepared.",
                label_advice: "Subconscious Advice",
                analysis_advice: "Not seeing the score means the result isn't set yet; fear comes from imagination. Try breaking down big tasks this week to regain a sense of control.",
                related_title: "Similar Dreams",
                rel_1_title: "Missing the Exam", rel_1_desc: "Always dreaming of losing the admission ticket...",
                rel_2_title: "Maze Elevator", rel_2_desc: "The elevator never reaches my floor...",
                // New translations for share function
                msg_copied: "Link copied to clipboard",
                msg_share_fail: "Unable to share"
            }
        };

        // Initialize
        window.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const langParam = urlParams.get('lang');
            if (langParam && translations[langParam]) {
                changeLanguage(langParam);
            }
        });

        // --- New Share Logic ---
        function handleShare() {
            const title = document.querySelector('[data-i18n="dream_title"]').innerText;
            const text = title;
            const url = window.location.href;

            // Check if Web Share API is supported (Usually mobile)
            if (navigator.share) {
                navigator.share({
                    title: title,
                    text: text,
                    url: url
                })
                .then(() => console.log('Shared successfully'))
                .catch((error) => {
                    console.log('Share canceled or failed', error);
                    // Fallback to copy if share fails (or user cancels on some browsers)
                    // Note: Some browsers reject share promises if cancelled, so we fallback nicely
                });
            } else {
                // Fallback for Desktop: Copy to Clipboard
                copyToClipboard(url);
            }
        }

        function copyToClipboard(text) {
            // Create a temporary textarea to handle the copy
            const textArea = document.createElement("textarea");
            textArea.value = text;
            
            // Ensure it's not visible but part of DOM
            textArea.style.position = "fixed";
            textArea.style.left = "-9999px";
            textArea.style.top = "0";
            document.body.appendChild(textArea);
            
            textArea.focus();
            textArea.select();

            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showToast(translations[currentLang].msg_copied);
                } else {
                    showToast(translations[currentLang].msg_share_fail);
                }
            } catch (err) {
                console.error('Fallback: Oops, unable to copy', err);
                showToast("Error");
            }

            document.body.removeChild(textArea);
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            const toastMsg = document.getElementById('toastMsg');
            
            toastMsg.innerText = message;
            
            // Show
            toast.classList.add('toast-enter');
            
            // Hide after 3 seconds
            setTimeout(() => {
                toast.classList.remove('toast-enter');
            }, 3000);
        }
        // -----------------------

        function changeLanguage(lang) {
            currentLang = lang; // Update global state

            // Update URL without refresh
            try {
                const url = new URL(window.location);
                url.searchParams.set('lang', lang);
                window.history.pushState({}, '', url);
            } catch (e) {
                console.log("URL update skipped (sandbox environment)");
            }

            // Update Label
            document.getElementById('currentLangLabel').innerText = lang === 'zh' ? '中文' : 'English';

            // Update Content
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[lang] && translations[lang][key]) {
                    el.innerText = translations[lang][key];
                }
            });
        }
    </script>
</body>
</html>